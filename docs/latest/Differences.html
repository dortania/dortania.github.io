<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>Differences</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="Differences.css" /> 
<meta name="src" content="Differences.tex" /> 
<link rel="stylesheet" type="text/css" href="../main.css" /></head><body 
><div class="center" 
>
<!--l. 142--><p class="noindent" >
</p><!--l. 149--><p class="noindent" > <img 
src="Logos/Logo-.png" alt="PIC"  
width="160" height="160"  />
</p><!--l. 153--><p class="noindent" >OpenCore
</p><!--l. 157--><p class="noindent" >Reference Manual (0.6<span class="sout">.7</span><span class="uwave">.8</span>)
</p><!--l. 161--><p class="noindent" >[2021.03.28]
</p><!--l. 169--><p class="noindent" >Copyright ©2018-2021 vit9696
</p>
</div>
                                                                                                  
                                                                                                  
<br /><span class="sectionToc" >9 <a 
href="#x1-480009" id="QQ2-1-51">NVRAM</a></span>
<br /> <span class="subsectionToc" >9.1 <a 
href="#x1-490001" id="QQ2-1-52">Introduction</a></span>
<br /> <span class="subsectionToc" >9.2 <a 
href="#x1-500002" id="QQ2-1-53">Properties</a></span>
<br /> <span class="subsectionToc" >9.3 <a 
href="#x1-510003" id="QQ2-1-54">Mandatory Variables</a></span>
<br /><span class="sectionToc" >10 <a 
href="#x1-5400010" id="QQ2-1-57">PlatformInfo</a></span>
<br /> <span class="subsectionToc" >10.1 <a 
href="#x1-550001" id="QQ2-1-58">Properties</a></span>
<br /> <span class="subsectionToc" >10.2 <a 
href="#x1-560002" id="QQ2-1-59">Generic Properties</a></span>
<br /> <span class="subsectionToc" >10.4 <a 
href="#x1-580004" id="QQ2-1-61">Memory Properties</a></span>
<br /><span class="sectionToc" >11 <a 
href="#x1-6200011" id="QQ2-1-65">UEFI</a></span>
<br /> <span class="subsectionToc" >11.1 <a 
href="#x1-630001" id="QQ2-1-66">Introduction</a></span>
<br /> <span class="subsectionToc" >11.2 <a 
href="#x1-640002" id="QQ2-1-67">Drivers</a></span>
<br /> <span class="subsectionToc" >11.3 <a 
href="#x1-650003" id="QQ2-1-68">Tools and Applications</a></span>
<br /> <span class="subsectionToc" >11.4 <a 
href="#x1-660004" id="QQ2-1-70">OpenCanopy</a></span>
<br /> <span class="subsectionToc" >11.7 <a 
href="#x1-690007" id="QQ2-1-73">APFS Properties</a></span>
<br /> <span class="subsectionToc" >11.8 <a 
href="#x1-700008" id="QQ2-1-74">Audio Properties</a></span>
<br /> <span class="subsectionToc" >11.9 <a 
href="#x1-710009" id="QQ2-1-75">Input Properties</a></span>
<br /> <span class="subsectionToc" >11.10 <a 
href="#x1-7200010" id="QQ2-1-76">Output Properties</a></span>
<br /><span class="sectionToc" >12 <a 
href="#x1-7600012" id="QQ2-1-80">Troubleshooting</a></span>
<br /> <span class="subsectionToc" >12.1 <a 
href="#x1-770001" id="QQ2-1-81">Legacy Apple OS</a></span>
<br /> <span class="subsectionToc" >12.3 <a 
href="#x1-840003" id="QQ2-1-88">Windows support</a></span>
<br /> <span class="subsectionToc" >12.4 <a 
href="#x1-850004" id="QQ2-1-90">Debugging</a></span>
<br /> <span class="subsectionToc" >12.5 <a 
href="#x1-860005" id="QQ2-1-91">Tips and Tricks</a></span>
</div>
<a 
 id="x1-1001r1"></a>
<h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 178--><p class="noindent" >This document provides information on the <span class="uwave">format of the </span><a 
href="https://github.com/acidanthera/OpenCorePkg" >OpenCore</a> user configuration file <span class="sout">format </span>used to set up the correct
functioning of the macOS operating system. It is to be read as the official clarification of expected OpenCore behaviour. All
deviations, if found in published OpenCore releases, shall be considered to be documentation or implementation
issues which should be reported via the <a 
href="https://github.com/acidanthera/bugtracker" >Acidanthera Bugtracker</a>. An errata sheet is available in <a 
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Errata/Errata.pdf" >OpenCorePkg
repository</a>.
</p><!--l. 188--><p class="noindent" >This document is structured as a specification and is not meant to provide a step-by-step guide to configuring an end-user
Board Support Package (BSP). The intended audience of the document is anticipated to be programmers and engineers with a
basic understanding of macOS internals and UEFI functionality. For these reasons, this document is available
exclusively in English, and all other sources or translations of this document are unofficial and may contain
errors.
</p><!--l. 195--><p class="noindent" >Third-party articles, utilities, books, and similar, may be more useful for a wider audience as they could provide
guide-like material. However, they are subject to their authors’ preferences, <span class="sout">tastes, </span>misinterpretations of this
document, and unavoidable obsolescence. In cases of using such sources, such as <a 
href="https://dortania.github.io" >Dortania</a>’s <a 
href="https://dortania.github.io/OpenCore-Install-Guide" >OpenCore Install
Guide</a> and <a 
href="https://dortania.github.io/getting-started" >related material</a>, please refer back to this document on every decision made and re-evaluate potential
<span class="sout">consequences</span><span class="uwave">implications</span>.
</p><!--l. 203--><p class="noindent" >Please note that regardless of the sources used, users are required to fully understand every OpenCore configuration option,
and the principles behind them, before posting issues to the <a 
href="https://github.com/acidanthera/bugtracker" >Acidanthera Bugtracker</a>.
                                                                                                  
                                                                                                  
<h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-50001"></a>Configuration Terms</h4>
     <ul class="itemize1">
     <li class="itemize">OC config — OpenCore Configuration file in plist format named config.plist. It provides an extensible way
     to configure OpenCore and is structured to be separated into multiple named sections situated under the root
     plist dictionary. These sections may have plist array or plist dictionary types and are described in
     corresponding sections of this document.
     </li>
     <li class="itemize">valid key — plist key object of OC config described in this document or its future revisions. Besides explicitly
     described valid keys, keys starting with the # symbol (e.g. #Hello) are also considered valid keys and while
     they behave as comments, effectively discarding their values, they are still required to be valid plist objects.
     All other plist keys are not valid, and their presence results in undefined behaviour.
     </li>
     <li class="itemize">valid value — valid plist object of OC config described in this document that matches all the additional
     requirements in specific plist object descriptions if any.
     </li>
     <li class="itemize">invalid value — valid plist object of OC config described in this document that is of other plist type,
     does not conform to additional requirements found in specific plist object descriptions (e.g. value range), or
     missing from the corresponding collection. Invalid values are read with or without an error message as any
     possible value of this plist object in an undetermined manner (i.e. the values may not be same across the
     reboots). Whilst reading an invalid value is equivalent to reading certain defined valid values, applying
     incompatible values to the host system may result in undefined behaviour.
     </li>
     <li class="itemize">optional value — valid value of OC config described in this document that reads in a certain defined manner
     provided in specific plist object description (instead of invalid value) when not present in OC config. All
     other cases of invalid value do still apply. Unless explicitly marked as optional value, any other value is
     required to be present and reads to invalid value if missing.
     </li>
     <li class="itemize">fatal behaviour — behaviour leading to boot termination. Implementations shall prevent the boot process
     from continuing until the host system is restarted. It is permitted, but not required, to execute cold reboots or
     to show warning messages in such cases.
     </li>
     <li class="itemize">undefined behaviour — behaviour not prescribed by this document. Implementations may take any measures
     including, but not limited to, measures associated with fatal behaviour, assumptions of any state or value, or
     disregarding any associated states or values. This is however subject to such measures not negatively impacting
     upon system integrity.</li></ul>
<a 
 id="x1-5001r6"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-60002"></a>Configuration Processing</h4>
<!--l. 341--><p class="noindent" >The OC config file is guaranteed to be processed at least once if found. <span class="sout">Depending on </span><span class="uwave">Subject to the </span>OpenCore bootstrapping
mechanism, the presence of multiple OC config files may lead to the reading of any of them. It is permissible for no OC Config
file to be present on disk. In such cases, if the implementation does not abort the boot process, all values shall follow the rules
of invalid values and optional values.
</p><!--l. 348--><p class="noindent" >The OC config file has restrictions on size, nesting levels, and number of keys:
</p>
     <ul class="itemize1">
     <li class="itemize">The OC config file size shall not exceed 32 MBs.
     </li>
     <li class="itemize">The OC config file shall not have more than 32 nesting levels.
     </li>
     <li class="itemize">The OC config file may have up to 32,768 XML nodes within each plist object.
         <ul class="itemize2">
         <li class="itemize">One plist dictionary item is counted as a pair of nodes</li></ul>
     </li></ul>
                                                                                                  
                                                                                                  
<!--l. 365--><p class="noindent" >Reading malformed OC config files results in undefined behaviour. Examples of malformed OC config files include the
following:
</p>
     <ul class="itemize1">
     <li class="itemize">OC config files that do not conform to DTD PLIST 1.0.
     </li>
     <li class="itemize">OC config files with unsupported or non-conformant plist objects found in this document.
     </li>
     <li class="itemize">OC config files violating restrictions on size, nesting levels, and number of keys.</li></ul>
<!--l. 380--><p class="noindent" >It is recommended, but not required, to abort loading malformed OC config files and to continue as if an OC config file is not
present. For forward compatibility, it is recommended, but not required, for the implementation to warn about the use of
invalid values.
</p><!--l. 385--><p class="noindent" >The recommended <span class="sout">practice for </span><span class="uwave">approach to </span>interpreting invalid values is to conform to the following convention where
applicable:
</p>
<div class="center" 
>
<!--l. 388--><p class="noindent" >
</p>
<div class="tabular"> <table id="TBL-1" class="tabular" 
 
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1" /></colgroup><colgroup id="TBL-1-2g"><col 
id="TBL-1-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td11">Type            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-2"  
class="td11">Value                                  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-1"  
class="td11">plist string  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-2"  
class="td11">Empty string (&#x003C;string&#x003E;&#x003C;/string&#x003E;)</td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-1"  
class="td11">plist data    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-2"  
class="td11">Empty data (&#x003C;data&#x003E;&#x003C;/data&#x003E;)        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-1"  
class="td11">plist integer </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-2"  
class="td11">0 (&#x003C;integer&#x003E;0&#x003C;/integer&#x003E;)           </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-1"  
class="td11">plist boolean </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-2"  
class="td11">False (&#x003C;false/&#x003E;)                         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-1"  
class="td11">plist tristate</td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-2"  
class="td11">False (&#x003C;false/&#x003E;)                         </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-7-1"  
class="td11">              </td>
</tr></table></div></div>
<a 
 id="x1-6001r7"></a>
<h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-70003"></a>Configuration Structure</h4>
<!--l. 413--><p class="noindent" >The OC config file is separated into subsections, as described in separate sections of this document, and is designed so as to
attempt not to enable anything by default as well as to provide kill switches via an Enable property for plist dict entries
that represent optional plugins and similar.
</p><!--l. 418--><p class="noindent" >The file is structured to group related elements in subsections as follows:
</p>
     <ul class="itemize1">
     <li class="itemize">Add provides support for data addition. Existing data will not be overridden, and needs to be handled separately
     with Delete if necessary.
     </li>
     <li class="itemize">Delete provides support for data removal.
     </li>
     <li class="itemize">Patch provides support for data modification.
     </li>
     <li class="itemize">Quirks provides support for specific workarounds.</li></ul>
<!--l. 434--><p class="noindent" >Root configuration entries consist of the following:
</p>
     <ul class="itemize1">
     <li class="itemize"><a 
href="#x1-140004">ACPI</a>
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize"><a 
href="#x1-270006">DeviceProperties</a>
     </li>
     <li class="itemize"><a 
href="#x1-310007">Kernel</a>
                                                                                                  
                                                                                                  
     </li>
     <li class="itemize">boot <br 
class="newline" />Duet bootstrap loader, which initialises the UEFI environment on legacy BIOS firmware and loads OpenCore.efi
     similarly to other bootstrap loaders. A modern Duet bootstrap loader will default to OpenCore.efi on the same
     partition when present.
     </li>
     <li class="itemize">ACPI <br 
class="newline" />Directory used for storing supplemental ACPI information for the <a 
href="#x1-140004">ACPI</a> section.
     </li>
     <li class="itemize">Drivers <br 
class="newline" />Directory used for storing supplemental UEFI drivers for <a 
href="#x1-6200011">UEFI</a> section.
     </li>
     <li class="itemize">Kexts <br 
class="newline" />Directory used for storing supplemental kernel information for the <a 
href="#x1-310007">Kernel</a> section.
     </li>
     <li class="itemize">Resources <br 
class="newline" />Directory used for storing media resources such as audio files for screen reader support. <span class="sout">See </span><span class="uwave">Refer to </span>the <a 
href="#x1-700008">UEFI
     Audio Properties</a> section for more details. This directory also contains image files for graphical user interface.
     <span class="sout">See </span><span class="uwave">Refer to </span>the <a 
href="#x1-660004">OpenCanopy</a> section for more details.
     </li>
     <li class="itemize">Tools <br 
class="newline" />Directory used for storing supplemental tools.
     </li>
     <li class="itemize">OpenCore.efi <br 
class="newline" />Main booter application responsible for operating system loading. The directory OpenCore.efi resides in is called
     the root directory, which is set to EFI\OC by default. When launching OpenCore.efi directly or through a
     custom launcher however, other directories containing OpenCore.efi files are also supported.
     </li>
     <li class="itemize">config.plist <br 
class="newline" />OC Config.
     </li>
     <li class="itemize">vault.plist <br 
class="newline" />Hashes for all files potentially loadable by OC Config.
     </li>
     <li class="itemize">vault.sig <br 
class="newline" />Signature for vault.plist.
     </li>
     <li class="itemize">SysReport <br 
class="newline" />Directory containing system reports generated by SysReport option.
     </li>
     <li class="itemize">nvram.plist <br 
class="newline" />OpenCore variable import file.
     </li>
     <li class="itemize">opencore-YYYY-MM-DD-HHMMSS.txt <br 
class="newline" />OpenCore log file.
     </li>
     <li class="itemize">panic-YYYY-MM-DD-HHMMSS.txt <br 
class="newline" />Kernel panic log file.</li></ul>
<!--l. 630--><p class="noindent" >Note: It is not guaranteed that paths longer than OC_STORAGE_SAFE_PATH_MAX (128 characters including the
<br 
class="newline" />0-terminator) will be accessible within OpenCore.
<a 
 id="x1-9001r10"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-100002"></a>Installation and Upgrade</h4>
<!--l. 636--><p class="noindent" >To install OpenCore, replicate the <a 
href="#x1-70003">Configuration Structure</a> described in the previous section in the EFI volume of a
GPT partition. While corresponding sections of this document provide some information regarding external
                                                                                                  
                                                                                                  
resources such as ACPI tables, UEFI drivers, or kernel extensions (kexts), completeness of the matter is out of the
scope of this document. Information about kernel extensions may be found in a separate <a 
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Kexts.md" >Kext List</a> document
available in the OpenCore repository. Vaulting information is provided in the <a 
href="#x1-460005">Security Properties</a> section of this
document.
</p><!--l. 648--><p class="noindent" >The OC config file, as with any property list file, can be edited with any text editor, such as nano or vim. However, specialised
software may provide a better experience. On macOS, the preferred GUI application is <a 
href="https://developer.apple.com/xcode" >Xcode</a>. For a lightweight cross-platform
and open-source alternative, the <a 
href="https://github.com/corpnewt/ProperTree" >ProperTree</a> editor can be utilised.
</p><!--l. 656--><p class="noindent" >For BIOS booting, a third-party UEFI environment provider is required and OpenDuetPkg is one such UEFI environment
provider for legacy systems. To run OpenCore on such a legacy system, OpenDuetPkg can be installed with a dedicated tool —
BootInstall (bundled with OpenCore). <a 
href="https://github.com/corpnewt/gibMacOS" >Third-party utilities</a> can be used to perform this on systems other than
macOS.
</p><!--l. 663--><p class="noindent" >For upgrade purposes, refer to the Differences.pdf document which provides information about changes to the configuration
(as compared to the previous release) as well as to the Changelog.md document (which contains a list of modifications across
all published updates).
<a 
 id="x1-10001r11"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-110003"></a>Contribution</h4>
<!--l. 670--><p class="noindent" >OpenCore can be compiled as a standard <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II" >EDK II</a> package and requires the <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II#stable-tags" >EDK II Stable</a> package. The currently supported
EDK II release is hosted in <a 
href="https://github.com/acidanthera/audk" >acidanthera/audk</a>. Required patches for this package can be found in the Patches
directory.
</p><!--l. 678--><p class="noindent" >The only officially supported toolchain is XCODE5. Other toolchains might work but are neither supported nor recommended.
Contributions of clean patches are welcome. Please do follow <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/Code-Style-C" >EDK II C Codestyle</a>.
</p><!--l. 683--><p class="noindent" >To compile with XCODE5, besides <a 
href="https://developer.apple.com/xcode" >Xcode</a>, users should also install <a 
href="https://www.nasm.us" >NASM</a> and <a 
href="https://github.com/acidanthera/ocbuild/tree/master/external" >MTOC</a>. The latest Xcode version is recommended
for use despite the toolchain name. An example command sequence is as follows:
</p>
<!--l. 689-->
<a 
 id="x1-11001r1"></a>
<a 
 id="x1-11002"></a>
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-11003r1"></a></span>git clone --depth=1 https://github.com/acidanthera/audk UDK <br /><span class="label"><a 
 id="x1-11004r2"></a></span>cd UDK <br /><span class="label"><a 
 id="x1-11005r3"></a></span>git submodule update --init --recommend-shallow <br /><span class="label"><a 
 id="x1-11006r4"></a></span>git clone --depth=1 https://github.com/acidanthera/OpenCorePkg <br /><span class="label"><a 
 id="x1-11007r5"></a></span>source edksetup.sh <br /><span class="label"><a 
 id="x1-11008r6"></a></span>make -C BaseTools <br /><span class="label"><a 
 id="x1-11009r7"></a></span>build -a X64 -b RELEASE -t XCODE5 -p OpenCorePkg/OpenCorePkg.dsc
<figcaption class="caption" ><span class="id">Listing 1:</span><span  
class="content">Compilation Commands</span></figcaption><!--tex4ht:label?: x1-11001r -->
</div>
<!--l. 699--><p class="noindent" >For IDE usage Xcode projects are available in the root of the repositories. Another approach could be <a 
href="https://www.sublimetext.com" >Sublime Text</a> with
<a 
href="https://niosus.github.io/EasyClangComplete" >EasyClangComplete</a> plugin. Add .clang_complete file with similar content to the UDK root:
</p>
<!--l. 705-->
<a 
 id="x1-11010r2"></a>
<a 
 id="x1-11011"></a>
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-11012r1"></a></span>-I/UefiPackages/MdePkg <br /><span class="label"><a 
 id="x1-11013r2"></a></span>-I/UefiPackages/MdePkg/Include <br /><span class="label"><a 
 id="x1-11014r3"></a></span>-I/UefiPackages/MdePkg/Include/X64 <br /><span class="label"><a 
 id="x1-11015r4"></a></span>-I/UefiPackages/MdeModulePkg <br /><span class="label"><a 
 id="x1-11016r5"></a></span>-I/UefiPackages/MdeModulePkg/Include <br /><span class="label"><a 
 id="x1-11017r6"></a></span>-I/UefiPackages/MdeModulePkg/Include/X64 <br /><span class="label"><a 
 id="x1-11018r7"></a></span>-I/UefiPackages/OpenCorePkg/Include/AMI <br /><span class="label"><a 
 id="x1-11019r8"></a></span>-I/UefiPackages/OpenCorePkg/Include/Acidanthera <br /><span class="label"><a 
 id="x1-11020r9"></a></span>-I/UefiPackages/OpenCorePkg/Include/Apple <br /><span class="label"><a 
 id="x1-11021r10"></a></span>-I/UefiPackages/OpenCorePkg/Include/Apple/X64 <br /><span class="label"><a 
 id="x1-11022r11"></a></span>-I/UefiPackages/OpenCorePkg/Include/Duet <br /><span class="label"><a 
 id="x1-11023r12"></a></span>-I/UefiPackages/OpenCorePkg/Include/Generic <br /><span class="label"><a 
 id="x1-11024r13"></a></span>-I/UefiPackages/OpenCorePkg/Include/Intel <br /><span class="label"><a 
 id="x1-11025r14"></a></span>-I/UefiPackages/OpenCorePkg/Include/Microsoft <br /><span class="label"><a 
 id="x1-11026r15"></a></span><span class="uwave">-</span><span class="uwave">I</span><span class="uwave">/</span><span class="uwave">Ue</span><span class="uwave">fi</span><span class="uwave">Packages</span><span class="uwave">/</span><span class="uwave">OpenCorePkg</span><span class="uwave">/</span><span class="uwave">Include</span><span class="uwave">/</span><span class="uwave">Nvidia</span> <br /><span class="label"><a 
 id="x1-11027r16"></a></span>-I/UefiPackages/OpenCorePkg/Include/VMware <br /><span class="label"><a 
 id="x1-11028r17"></a></span>-I/UefiPackages/OvmfPkg/Include <br /><span class="label"><a 
 id="x1-11029r18"></a></span>-I/UefiPackages/UefiCpuPkg/Include <br /><span class="label"><a 
 id="x1-11030r19"></a></span>-IInclude <br /><span class="label"><a 
 id="x1-11031r20"></a></span>-include <br /><span class="label"><a 
 id="x1-11032r21"></a></span>/UefiPackages/MdePkg/Include/Uefi.h <br /><span class="label"><a 
 id="x1-11033r22"></a></span>-fshort-wchar <br /><span class="label"><a 
 id="x1-11034r23"></a></span>-Wall <br /><span class="label"><a 
 id="x1-11035r24"></a></span>-Wextra <br /><span class="label"><a 
 id="x1-11036r25"></a></span>-Wno-unused-parameter <br /><span class="label"><a 
 id="x1-11037r26"></a></span>-Wno-missing-braces <br /><span class="label"><a 
 id="x1-11038r27"></a></span>-Wno-missing-field-initializers <br /><span class="label"><a 
 id="x1-11039r28"></a></span>-Wno-tautological-compare <br /><span class="label"><a 
 id="x1-11040r29"></a></span>-Wno-sign-compare <br /><span class="label"><a 
 id="x1-11041r30"></a></span>-Wno-varargs <br /><span class="label"><a 
 id="x1-11042r31"></a></span>-Wno-unused-const-variable <br /><span class="label"><a 
 id="x1-11043r32"></a></span>-DOC_TARGET_NOOPT=1 <br /><span class="label"><a 
 id="x1-11044r33"></a></span>-DNO_MSABI_VA_FUNCS=1
<figcaption class="caption" ><span class="id">Listing 2:</span><span  
class="content">ECC Configuration</span></figcaption><!--tex4ht:label?: x1-11010r -->
</div>
<!--l. 742--><p class="noindent" >Warning: Tool developers modifying config.plist or any other OpenCore files must ensure that their tools check the
opencore-version NVRAM variable (see the <a 
href="#x1-450004">Debug Properties</a> section below) and warn users if the version listed is
unsupported or prerelease. The OpenCore configuration may change across releases and such tools shall ensure that they
carefully follow this document. Failure to do so may result in such tools being considered to be malware and blocked by any
means.
<a 
 id="x1-11045r12"></a>
                                                                                                  
                                                                                                  
     </li>
     <li class="itemize">Use DEBUG_ERROR to print critical human visible messages that may potentially halt the boot process, and
     DEBUG_WARN for all other human visible errors, RELEASE builds included.</li></ul>
<!--l. 856--><p class="noindent" >The <a 
href="https://git-scm.com/docs/git-bisect" >git-bisect</a> functionality may be useful when trying to find problematic changes. Unofficial sources of per-commit
OpenCore binary builds, such as <a 
href="https://dortania.github.io/builds" >Dortania</a>, may also be useful.
<a 
 id="x1-13001r9"></a>
</p>
<h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-140004"></a>ACPI</h3>
<a 
 id="x1-14001r16"></a>
<h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-150001"></a>Introduction</h4>
<!--l. 864--><p class="noindent" >ACPI (Advanced Configuration and Power Interface) is an open standard to discover and configure computer hardware. The
<a 
href="https://uefi.org/specifications" >ACPI specification</a> <span class="sout">define the </span><span class="uwave">defines </span>standard tables (e.g. DSDT, SSDT, FACS, DMAR) and various methods (e.g. _DSM, _PRW) for
implementation. Modern hardware needs <span class="sout">little </span><span class="uwave">few </span>changes to maintain ACPI compatibility <span class="sout">, yet some of those </span><span class="uwave">and some
options for such changes </span>are provided as <span class="sout">a </span>part of OpenCore.
</p><!--l. 875--><p class="noindent" >To compile and disassemble ACPI tables, the <a 
href="https://github.com/acpica/acpica" >iASL compiler</a> developed by <a 
href="https://www.acpica.org" >ACPICA</a> can be used. A GUI front-end to iASL
compiler can be downloaded from <a 
href="https://github.com/acidanthera/MaciASL/releases" >Acidanthera/MaciASL</a>.
</p><!--l. 879--><p class="noindent" >ACPI changes apply globally (to every operating system) with the following effective order:
</p>
     <ul class="itemize1">
     <li class="itemize">Patch is processed.
     </li>
     <li class="itemize">Delete is processed.
     </li>
     <li class="itemize">Add is processed.
     </li>
     <li class="itemize">Quirks are processed.</li></ul>
<!--l. 889--><p class="noindent" >Applying the changes globally resolves the problems of incorrect operating system detection (consistent with the ACPI
specification, not possible before the operating system boots), operating system chainloading, and difficult ACPI debugging.
Hence, more attention may be required when writing changes to _OSI.
</p><!--l. 894--><p class="noindent" >Applying the patches early makes it possible to write so called “proxy” patches, where the original method is patched in the
original table and is implemented in the patched table.
</p><!--l. 898--><p class="noindent" >There are several sources of ACPI tables and workarounds. Commonly used ACPI tables are provided with OpenCore,
VirtualSMC, VoodooPS2, and WhateverGreen releases. Besides those, several third-party instructions may be found on the
AppleLife <a 
href="https://applelife.ru/forums/xakintosh.67" >Laboratory</a> and <a 
href="https://applelife.ru/forums/dsdt.129" >DSDT</a> subforums (e.g. <a 
href="https://applelife.ru/posts/498967" >Battery register splitting</a> guide). A slightly more user-friendly explanation of
some tables included with OpenCore can also be found in <a 
href="https://dortania.github.io" >Dortania</a>’s <a 
href="https://dortania.github.io/Getting-Started-With-ACPI" >Getting started with ACPI</a> guide. For more exotic cases,
there are several alternatives such as <a 
href="https://github.com/daliansky" >daliansky</a>’s <a 
href="https://github.com/daliansky/OC-little" >ACPI sample collection</a>. Note however that the quality of the suggested
solutions will be variable.
<a 
 id="x1-15001r18"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-160002"></a>Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-16002x1">Add<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Load selected tables from the OC/ACPI directory.
     <!--l. 922--><p class="noindent" ><span class="sout">Designed to </span><span class="uwave">To </span>be filled with plist dict values, describing each add entry. <span class="sout">See </span><span class="uwave">Refer to </span>the <a 
href="#x1-170003">Add Properties</a>
     section below.
     </p></li>
     <li 
  class="enumerate" id="x1-16004x2">Delete<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Remove selected tables from the ACPI stack.
     <!--l. 931--><p class="noindent" ><span class="sout">Designed to </span><span class="uwave">To </span>be filled with plist dict values, describing each delete entry. <span class="sout">See </span><span class="uwave">Refer to </span>the <a 
href="#x1-180004">Delete Properties</a>
     section below.
     </p></li>
     <li 
  class="enumerate" id="x1-16006x3">Patch<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Perform binary patches in ACPI tables before table addition or removal.
     <!--l. 941--><p class="noindent" ><span class="sout">Designed to </span><span class="uwave">To </span>be filled with plist dictionary values describing each patch entry. <span class="sout">See </span><span class="uwave">Refer to </span>the <a 
href="#x1-190005">Patch
     Properties</a> section below.
     </p></li>
     <li 
  class="enumerate" id="x1-16008x4">Quirks<br 
class="newline" />Type: plist dict<br 
class="newline" />Description: Apply individual ACPI quirks described in the <a 
href="#x1-200006">Quirks Properties</a> section below.
     </li></ol>
<a 
 id="x1-16009r19"></a>
<h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-170003"></a>Add Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-17002x1">Comment<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Arbitrary ASCII string used to provide human readable reference for the entry. Whether this value
     is used is implementation defined.
     </li>
     <li 
  class="enumerate" id="x1-17004x2">Enabled<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Set to true to add this ACPI table.
     </li>
     <li 
  class="enumerate" id="x1-17006x3">Path<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description:   File   paths   meant   to   be   loaded   as   ACPI   tables.   Example   values   include   DSDT.aml,
     SubDir/SSDT-8.aml, SSDT-USBX.aml, etc.
     <!--l. 976--><p class="noindent" >The ACPI table load order follows the item order in the array. ACPI tables are loaded from the OC/ACPI directory.
     </p><!--l. 979--><p class="noindent" >Note: All tables apart from tables with a DSDT table identifier (determined by parsing data, not by filename)
     insert new tables into the ACPI stack. DSDT tables perform a replacement of DSDT tables instead.
</p>
     </li></ol>
<a 
 id="x1-17007r20"></a>
<h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-180004"></a>Delete Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-18002x1">All<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false (Only delete the first matched table)<br 
class="newline" />Description: Set to true to delete all ACPI tables matching the condition.
     </li>
     <li 
  class="enumerate" id="x1-18004x2">Comment<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Arbitrary ASCII string used to provide human readable reference for the entry. Whether this value
     is used is implementation defined.
     </li>
     <li 
  class="enumerate" id="x1-18006x3">Enabled<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Set to true to remove this ACPI table.
     </li>
     <li 
  class="enumerate" id="x1-18008x4">OemTableId<br 
class="newline" />Type: plist data, 8 bytes<br 
class="newline" />Failsafe: All zero (Match any table OEM ID)<br 
class="newline" />Description: Match table OEM ID equal to this value.
     </li>
     <li 
  class="enumerate" id="x1-18010x5">TableLength<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0 (Match any table size)<br 
class="newline" />Description: Match table size equal to this value.
     </li>
     <li 
  class="enumerate" id="x1-18012x6">TableSignature<br 
class="newline" />Type: plist data, 4 bytes<br 
class="newline" />Failsafe: All zero (Match any table signature)<br 
class="newline" />Description: Match table signature equal to this value.
     <!--l. 1026--><p class="noindent" >Note: Do not use table signatures when the sequence must be replaced in multiple places. This is particularly
     relevant when performing different types of renames.
</p>
     </li></ol>
<a 
 id="x1-18013r21"></a>
<h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-190005"></a>Patch Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-19002x1"><span class="uwave">Base</span><br 
class="newline" /><span class="uwave">Type</span><span class="uwave">: </span><span class="uwave">plist string</span><br 
class="newline" /><span class="uwave">Failsafe</span><span class="uwave">: Empty (Ignored)</span><br 
class="newline" /><span class="uwave">Description</span><span class="uwave">: Selects ACPI path base for patch lookup (or immediate replacement) by obtaining the offset to
     the provided path. </span>
     <!--l. 1044--><p class="noindent" ><span class="uwave">Only fully-qualified absolute paths are supported (e.g. </span><span class="uwave">\_SB.PCI0.LPCB.HPET</span><span class="uwave">). Currently supported object types
     are: </span><span class="uwave">Device</span><span class="uwave">, </span><span class="uwave">Field</span><span class="uwave">, </span><span class="uwave">Method</span><span class="uwave">. </span>
     </p><!--l. 1048--><p class="noindent" ><span class="uwave">Note</span><span class="uwave">: Use with care, not all OEM tables can be parsed. Use </span><span class="uwave">ACPIe</span> <span class="uwave">utility to debug. </span><span class="uwave">ACPIe</span> <span class="uwave">compiled with </span><span class="uwave">DEBUG=1
     make</span> <span class="uwave">command produces helpful ACPI lookup tracing. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-19004x2"><span class="uwave">BaseSkip</span><br 
class="newline" /><span class="uwave">Type</span><span class="uwave">: </span><span class="uwave">plist integer</span><br 
class="newline" /><span class="uwave">Failsafe</span><span class="uwave">: </span><span class="uwave">0</span> <span class="uwave">(Do not skip any occurrences)</span><br 
class="newline" /><span class="uwave">Description</span><span class="uwave">: Number of found </span><span class="uwave">Base</span> <span class="uwave">occurrences to skip before finds and replacements are applied. </span>
     </li>
     <li 
  class="enumerate" id="x1-19006x3">Comment<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Arbitrary ASCII string used to provide human readable reference for the entry. Whether this value
     is used is implementation defined.
     </li>
                                                                                                  
                                                                                                  
     <li 
  class="enumerate" id="x1-19008x4">Count<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0 (Apply patch to all occurrences found)<br 
class="newline" />Description: Number of occurrences to patch.
     </li>
     <li 
  class="enumerate" id="x1-19010x5">Enabled<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Set to true to apply this ACPI patch.
     </li>
     <li 
  class="enumerate" id="x1-19012x6">Find<br 
class="newline" />Type: plist data<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Data to find. Must be equal to Replace in size if set.
     <!--l. 1086--><p class="noindent" ><span class="uwave">Note</span><span class="uwave">: Can be empty, when </span><span class="uwave">Base</span> <span class="uwave">is specified, immediate replacement after </span><span class="uwave">Base</span> <span class="uwave">lookup happens in this case. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-19014x7">Limit<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0 (Search entire ACPI table)<br 
class="newline" />Description: Maximum number of bytes to search for.
     </li>
     <li 
  class="enumerate" id="x1-19016x8">Mask<br 
class="newline" />Type: plist data<br 
class="newline" />Failsafe: Empty (Ignored)<br 
class="newline" />Description: Data bitwise mask used during find comparison. Allows fuzzy search by ignoring not masked (set
     to zero) bits. Must be equal to Replace in size if set.
     </li>
     <li 
  class="enumerate" id="x1-19018x9">OemTableId<br 
class="newline" />Type: plist data, 8 bytes<br 
class="newline" />Failsafe: All zero (Match any table OEM ID)<br 
class="newline" />Description: Match table OEM ID equal to this value.
     </li>
     <li 
  class="enumerate" id="x1-19020x10">Replace<br 
class="newline" />Type: plist data<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Replacement data of one or more bytes.
     </li>
     <li 
  class="enumerate" id="x1-19022x11">ReplaceMask<br 
class="newline" />Type: plist data<br 
class="newline" />Failsafe: Empty (Ignored)<br 
class="newline" />Description: Data bitwise mask used during replacement. Allows fuzzy replacement by updating masked (set
     to non-zero) bits. Must be equal to Replace in size if set.
     </li>
     <li 
  class="enumerate" id="x1-19024x12">Skip<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0 (Do not skip any occurrences)<br 
class="newline" />Description: Number of found occurrences to skip before replacements are applied.
     </li>
     <li 
  class="enumerate" id="x1-19026x13">TableLength<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0 (Match any table size)<br 
class="newline" />Description: Match table size equal to this value.
                                                                                                  
                                                                                                  
     </li>
     <li 
  class="enumerate" id="x1-19028x14">TableSignature<br 
class="newline" />Type: plist data, 4 bytes<br 
class="newline" />Failsafe: All zero (Match any table signature)<br 
class="newline" />Description: Match table signature equal to this value.
     </li></ol>
<!--l. 1145--><p class="noindent" >In most cases, ACPI patches are not useful and are harmful:
</p>
     <ul class="itemize1">
     <li class="itemize">Avoid renaming devices with ACPI patches. This may fail or perform improper renaming of unrelated devices
     (e.g. EC and EC0), be unnecessary, or even fail to rename devices in certain tables. For ACPI consistency it is
     much safer to rename devices at the I/O Registry level, as done by <a 
href="https://github.com/acidanthera/WhateverGreen" >WhateverGreen</a>.
     </li>
     <li class="itemize">Avoid patching _OSI to support a higher feature set level whenever possible. While this enables a number of
     workarounds on APTIO firmware, it typically results in a need for additional patches. <span class="sout">Modern firmware generally
     does not need this </span><span class="uwave">These are not usually needed on modern firmware </span>and smaller patches work well on firmware
     that does. However, laptop vendors often rely on this method to determine the availability of functions such as
     modern I2C input support, thermal adjustment and custom feature additions.
     </li>
     <li class="itemize">Avoid patching embedded controller event _Qxx just to enable brightness keys. The conventional process to find
     these keys typically involves significant modifications to DSDT and SSDT files and in addition, the debug kext
     is not stable on newer systems. Please use the built-in brightness key discovery in <a 
href="https://github.com/acidanthera/BrightnessKeys" >BrightnessKeys</a> instead.
     </li>
     <li class="itemize">Avoid making ad hoc changes such as renaming _PRW or _DSM whenever possible.</li></ul>
<!--l. 1175--><p class="noindent" >Some cases where patching is actually useful include:
</p>
     <ul class="itemize1">
     <li class="itemize">Refreshing HPET (or another device) method header to avoid compatibility checks by _OSI on legacy hardware.
     _STA method  with  if ((OSFL () == Zero)) { If (HPTE) ... Return (Zero) content  may  be  forced  to
     always return 0xF by replacing A0 10 93 4F 53 46 4C 00 with A4 0A 0F A3 A3 A3 A3 A3.
     </li>
     <li class="itemize">To provide a custom method implementation within an SSDT, to inject shutdown fixes on certain computers for
     instance, the original method can be replaced with a dummy name by patching _PTS with ZPTS and adding a
     callback to the original method.</li></ul>
<!--l. 1191--><p class="noindent" >The Tianocore <a 
href="https://github.com/acidanthera/audk/blob/master/MdePkg/Include/IndustryStandard/AcpiAml.h" >AcpiAml.h</a> source file may help with better understanding ACPI opcodes.
</p><!--l. 1193--><p class="noindent" >Note: Patches of different Find and Replace lengths are unsupported as they may corrupt ACPI tables and make the system
unstable due to area relocation. If such changes are needed, the utilisation of “proxy” patching or the padding of NOP to the
remaining area could be considered.
<a 
 id="x1-19029r22"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">4.6   </span> <a 
 id="x1-200006"></a>Quirks Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-20002x1">FadtEnableReset<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Provide reset register and flag in FADT table to enable reboot and shutdown.
     <!--l. 1209--><p class="noindent" >Mainly  required  on  legacy  hardware  and  a  few  newer  laptops.  Can  also  fix  power-button  shortcuts.  Not
     recommended unless required.
     </p></li>
     <li 
  class="enumerate" id="x1-20004x2">NormalizeHeaders                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </body>
</html>
<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>Differences</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="Differences.css" /> 
<meta name="src" content="Differences.tex" /> 
<link rel="stylesheet" type="text/css" href="../main.css" /></head><body 
><div class="center" 
>
<!--l. 142--><p class="noindent" >
</p><!--l. 149--><p class="noindent" > <img 
src="Logos/Logo-.png" alt="PIC"  
width="160" height="160"  />
</p><!--l. 153--><p class="noindent" >OpenCore
</p><!--l. 157--><p class="noindent" >Reference Manual (0.6<span class="sout">.5</span><span class="uwave">.6</span>)
</p><!--l. 161--><p class="noindent" >[2021.02.26]
</p><!--l. 169--><p class="noindent" >Copyright ©2018-2021 vit9696
</p>
</div>
                                                                                                  
                                                                                                  
file.
</p><!--l. 450--><p class="noindent" >Note: Currently most properties try to have defined values even if not specified in the configuration for safety reasons. This
behaviour should not be relied upon, and all fields must be properly specified in the configuration.
<a 
 id="x1-7001r5"></a>
</p>
<h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-80003"></a>Setup</h3>
<a 
 id="x1-8001r8"></a>
<h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-90001"></a>Directory Structure</h4>
<div class="center" 
>
<!--l. 458--><p class="noindent" >
                                                                                                  
                                                                                                  
<!--l. 631--><p class="noindent" ><object data="Differences-1.svg" width="282.16095 " height="727.05132 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <tspan font-family="ec-lmr" font-size="10">Figure 1. Directory Structure</tspan></p></div>
<!--l. 637--><p class="noindent" ><tspan font-family="ec-lmr" font-size="10">When directory boot is used the directory structure used should follow the description on </tspan><a 
href="#x1-90001"><tspan font-family="ec-lmr" font-size="10">Directory Structure</tspan></a> <tspan font-family="ec-lmr" font-size="10">figure. Available</tspan>
<tspan font-family="ec-lmr" font-size="10">entries include:</tspan>
</p>
     <ul class="itemize1">
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">BOOTx64.efi </tspan><span class="sout"><tspan font-family="ec-lmr" font-size="10">and </tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">or </tspan></span><span class="sout"><tspan font-family="ec-lmtt" font-size="10">Bootstrap</tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">BOOTIa32</tspan></span><tspan font-family="ec-lmtt" font-size="10">.efi </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Initial bootstrap loaders, which </tspan><span class="sout"><tspan font-family="ec-lmr" font-size="10">loads </tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">load </tspan></span><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi</tspan><span class="sout"><tspan font-family="ec-lmr" font-size="10">unless it was already started as a driver</tspan></span><tspan font-family="ec-lmr" font-size="10">. </tspan><tspan font-family="ec-lmtt" font-size="10">BOOTx64.efi</tspan>
     <tspan font-family="ec-lmr" font-size="10">is loaded by the firmware by default according to UEFI specification, </tspan><span class="sout"><tspan font-family="ec-lmr" font-size="10">and </tspan></span><span class="sout"><tspan font-family="ec-lmtt" font-size="10">Bootstrap.efi</tspan></span> <span class="sout"><tspan font-family="ec-lmr" font-size="10">can be registered as a</tspan>
     <tspan font-family="ec-lmr" font-size="10">custom option </tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">yet it can also be renamed and put to a custom location </tspan></span><tspan font-family="ec-lmr" font-size="10">to let OpenCore coexist with operating</tspan>
     <tspan font-family="ec-lmr" font-size="10">systems using </tspan><tspan font-family="ec-lmtt" font-size="10">BOOTx64.efi </tspan><tspan font-family="ec-lmr" font-size="10">as their own loaders (e.g. Windows), see </tspan><span class="sout"><tspan font-family="ec-lmtt" font-size="10">BootProtect</tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">LauncherOption</tspan></span> <tspan font-family="ec-lmr" font-size="10">for more</tspan>
                                                                                                  
                                                                                                  
     <tspan font-family="ec-lmr" font-size="10">details.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">boot </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Duet bootstrap loader, which initialises UEFI environment on legacy BIOS firmware and loads </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi</tspan>
     <tspan font-family="ec-lmr" font-size="10">similarly to other bootstrap loaders. Modern Duet bootstrap loader will default to </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi </tspan><tspan font-family="ec-lmr" font-size="10">on the same</tspan>
     <tspan font-family="ec-lmr" font-size="10">partition when present.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">ACPI </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory used for storing supplemental ACPI information for</tspan> <tspan font-family="ec-lmbx" font-size="10">??</tspan> <tspan font-family="ec-lmr" font-size="10">section.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">Drivers </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory used for storing supplemental </tspan><tspan font-family="ec-lmtt" font-size="10">UEFI </tspan><tspan font-family="ec-lmr" font-size="10">drivers for </tspan><a 
href="#x1-6200011"><tspan font-family="ec-lmtt" font-size="10">UEFI</tspan></a> <tspan font-family="ec-lmr" font-size="10">section.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">Kexts </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory used for storing supplemental kernel information for</tspan> <tspan font-family="ec-lmbx" font-size="10">??</tspan> <tspan font-family="ec-lmr" font-size="10">section.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">Resources </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory used for storing media resources, such as audio files for screen reader support. See</tspan> <tspan font-family="ec-lmbx" font-size="10">??</tspan> <tspan font-family="ec-lmr" font-size="10">section for more</tspan>
     <tspan font-family="ec-lmr" font-size="10">details. This directory also contains image files for graphical user interface. See </tspan><a 
href="#x1-660004"><tspan font-family="ec-lmr" font-size="10">OpenCanopy</tspan></a> <tspan font-family="ec-lmr" font-size="10">section for more</tspan>
     <tspan font-family="ec-lmr" font-size="10">details.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">Tools </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory used for storing supplemental tools.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Main booter </tspan><span class="sout"><tspan font-family="ec-lmr" font-size="10">driver </tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">application </tspan></span><tspan font-family="ec-lmr" font-size="10">responsible for operating system loading. The directory </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi </tspan><tspan font-family="ec-lmr" font-size="10">resides is</tspan>
     <tspan font-family="ec-lmr" font-size="10">called the </tspan><tspan font-family="ec-lmtt" font-size="10">root directory</tspan><tspan font-family="ec-lmr" font-size="10">. By default </tspan><tspan font-family="ec-lmtt" font-size="10">root directory </tspan><tspan font-family="ec-lmr" font-size="10">is set to </tspan><tspan font-family="ec-lmtt" font-size="10">EFI\OC</tspan><tspan font-family="ec-lmr" font-size="10">, however, when launching </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi</tspan>
     <tspan font-family="ec-lmr" font-size="10">directly or through </tspan><span class="sout"><tspan font-family="ec-lmtt" font-size="10">Bootstrap.efi</tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">a custom launcher</tspan></span><tspan font-family="ec-lmr" font-size="10">, other directories containing </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCore.efi </tspan><tspan font-family="ec-lmr" font-size="10">can also be</tspan>
     <tspan font-family="ec-lmr" font-size="10">supported.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">config.plist </tspan><br 
class="newline" /><tspan font-family="ec-lmtt" font-size="10">OC Config</tspan><tspan font-family="ec-lmr" font-size="10">.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">vault.plist </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Hashes for all files potentially loadable by </tspan><tspan font-family="ec-lmtt" font-size="10">OC Config</tspan><tspan font-family="ec-lmr" font-size="10">.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">vault.sig </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Signature for </tspan><tspan font-family="ec-lmtt" font-size="10">vault.plist</tspan><tspan font-family="ec-lmr" font-size="10">.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">SysReport </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Directory containing system reports generated by </tspan><tspan font-family="ec-lmtt" font-size="10">SysReport </tspan><tspan font-family="ec-lmr" font-size="10">option.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">nvram.plist </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">OpenCore variable import file.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">opencore-YYYY-MM-DD-HHMMSS.txt </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">OpenCore log file.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">panic-YYYY-MM-DD-HHMMSS.txt </tspan><br 
class="newline" /><tspan font-family="ec-lmr" font-size="10">Kernel panic log file.</tspan></li></ul>
<!--l. 712--><p class="noindent" ><tspan font-family="ec-lmri" font-size="10">Note</tspan><tspan font-family="ec-lmr" font-size="10">: It is not guaranteed that paths longer than </tspan><tspan font-family="ec-lmtt" font-size="10">OC_STORAGE_SAFE_PATH_MAX </tspan><tspan font-family="ec-lmr" font-size="10">(128 characters including </tspan><br 
class="newline" /><tspan font-family="ec-lmtt" font-size="10">0</tspan><tspan font-family="ec-lmr" font-size="10">-terminator) will be accessible within OpenCore.</tspan>
<a 
 id="x1-9001r10"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark"><tspan font-family="ec-lmr" font-size="10">3.2   </tspan></span> <a 
 id="x1-100002"></a><tspan font-family="ec-lmr" font-size="10">Installation and Upgrade</tspan></h4>
<!--l. 718--><p class="noindent" ><tspan font-family="ec-lmr" font-size="10">To install OpenCore reflect the</tspan> <tspan font-family="ec-lmbx" font-size="10">??</tspan> <tspan font-family="ec-lmr" font-size="10">described in the previous section on a EFI volume of a GPT partition. While corresponding</tspan>
                                                                                                  
                                                                                                  
     <li class="itemize"><tspan font-family="ec-lmtt" font-size="10">sizeof </tspan><tspan font-family="ec-lmr" font-size="10">operator should take variables instead of types where possible to be error prone. Use </tspan><tspan font-family="ec-lmtt" font-size="10">ARRAY_SIZE </tspan><tspan font-family="ec-lmr" font-size="10">to</tspan>
     <tspan font-family="ec-lmr" font-size="10">obtain array size in elements. Use </tspan><tspan font-family="ec-lmtt" font-size="10">L_STR_LEN </tspan><tspan font-family="ec-lmr" font-size="10">and </tspan><tspan font-family="ec-lmtt" font-size="10">L_STR_SIZE </tspan><tspan font-family="ec-lmr" font-size="10">macros from </tspan><tspan font-family="ec-lmtt" font-size="10">OcStringLib </tspan><tspan font-family="ec-lmr" font-size="10">to obtain string literal</tspan>
     <tspan font-family="ec-lmr" font-size="10">sizes to ensure compiler optimisation.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Do not use </tspan><tspan font-family="ec-lmtt" font-size="10">goto </tspan><tspan font-family="ec-lmr" font-size="10">keyword. Prefer early </tspan><tspan font-family="ec-lmtt" font-size="10">return</tspan><tspan font-family="ec-lmr" font-size="10">, </tspan><tspan font-family="ec-lmtt" font-size="10">break</tspan><tspan font-family="ec-lmr" font-size="10">, or </tspan><tspan font-family="ec-lmtt" font-size="10">continue </tspan><tspan font-family="ec-lmr" font-size="10">after failing to pass error checking instead</tspan>
     <tspan font-family="ec-lmr" font-size="10">of nesting conditionals.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><tspan font-family="ec-lmtt" font-size="10">EFIAPI</tspan><tspan font-family="ec-lmr" font-size="10">, force UEFI calling convention, only in protocols, external callbacks between modules, and functions</tspan>
     <tspan font-family="ec-lmr" font-size="10">with variadic arguments.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Provide inline documentation to every added function, at least describing its inputs, outputs, precondition,</tspan>
     <tspan font-family="ec-lmr" font-size="10">postcondition, and giving a brief description.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Do not use </tspan><tspan font-family="ec-lmtt" font-size="10">RETURN_STATUS</tspan><tspan font-family="ec-lmr" font-size="10">. Assume </tspan><tspan font-family="ec-lmtt" font-size="10">EFI_STATUS </tspan><tspan font-family="ec-lmr" font-size="10">to be a matching superset that is to be always used when</tspan>
     <tspan font-family="ec-lmtt" font-size="10">BOOLEAN </tspan><tspan font-family="ec-lmr" font-size="10">is not enough.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Security violations should halt the system or cause a forced reboot.</tspan></li></ul>
<!--l. 898--><p class="noindent" ><tspan font-family="ec-lmbx" font-size="10">Codestyle</tspan><tspan font-family="ec-lmr" font-size="10">. The codebase follows </tspan><a 
href="https://github.com/tianocore/tianocore.github.io/wiki/Code-Style-C" ><tspan font-family="ec-lmr" font-size="10">EDK II codestyle</tspan></a> <tspan font-family="ec-lmr" font-size="10">with few changes and clarifications.</tspan> </p>
     <ul class="itemize1">
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Write inline documentation for the functions and variables only once: in headers, where a header prototype is</tspan>
     <tspan font-family="ec-lmr" font-size="10">available, and inline for </tspan><tspan font-family="ec-lmtt" font-size="10">static </tspan><tspan font-family="ec-lmr" font-size="10">variables and functions.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use line length of 120 characters or less, preferably 100 characters.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use spaces after casts, e.g. </tspan><tspan font-family="ec-lmtt" font-size="10">(VOID *)(UINTN) Variable</tspan><tspan font-family="ec-lmr" font-size="10">.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><span class="uwave"><tspan font-family="ec-lmr" font-size="10">two spaces to indent function arguments when splitting lines. </tspan></span>
     </li>
     <li class="itemize"><span class="uwave"><tspan font-family="ec-lmr" font-size="10">Prefix public functions with either </tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">Oc</tspan></span> <span class="uwave"><tspan font-family="ec-lmr" font-size="10">or another distinct name. </tspan></span>
     </li>
     <li class="itemize"><span class="uwave"><tspan font-family="ec-lmr" font-size="10">Do not prefix private </tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">static</tspan></span> <span class="uwave"><tspan font-family="ec-lmr" font-size="10">functions, but prefix private </tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">non-static</tspan></span> <span class="uwave"><tspan font-family="ec-lmr" font-size="10">functions with </tspan></span><span class="uwave"><tspan font-family="ec-lmtt" font-size="10">Internal</tspan></span><span class="uwave"><tspan font-family="ec-lmr" font-size="10">. </tspan></span>
     </li>
     <li class="itemize"><span class="uwave"><tspan font-family="ec-lmr" font-size="10">Use </tspan></span><tspan font-family="ec-lmr" font-size="10">SPDX license headers as shown in </tspan><a 
href="https://github.com/acidanthera/bugtracker/issues/483" ><tspan font-family="ec-lmr" font-size="10">acidanthera/bugtracker#483</tspan></a><tspan font-family="ec-lmr" font-size="10">.</tspan></li></ul>
<a 
 id="x1-12001r15"></a>
<h4 class="subsectionHead"><span class="titlemark"><tspan font-family="ec-lmr" font-size="10">3.5   </tspan></span> <a 
 id="x1-130005"></a><tspan font-family="ec-lmr" font-size="10">Debugging</tspan></h4>
<!--l. 916--><p class="noindent" ><tspan font-family="ec-lmr" font-size="10">The codebase incorporates EDK II debugging and few custom features to improve the experience.</tspan> </p>
     <ul class="itemize1">
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use module prefixes, 2-5 letters followed by a colon (</tspan><tspan font-family="ec-lmtt" font-size="10">:</tspan><tspan font-family="ec-lmr" font-size="10">), for debug messages. For </tspan><tspan font-family="ec-lmtt" font-size="10">OpenCorePkg </tspan><tspan font-family="ec-lmr" font-size="10">use </tspan><tspan font-family="ec-lmtt" font-size="10">OC:</tspan><tspan font-family="ec-lmr" font-size="10">, for</tspan>
     <tspan font-family="ec-lmr" font-size="10">libraries and drivers use their own unique prefixes.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Do not use dots (</tspan><tspan font-family="ec-lmtt" font-size="10">.</tspan><tspan font-family="ec-lmr" font-size="10">) in the end of debug messages and separate </tspan><tspan font-family="ec-lmtt" font-size="10">EFI_STATUS</tspan><tspan font-family="ec-lmr" font-size="10">, printed by </tspan><tspan font-family="ec-lmtt" font-size="10">%r</tspan><tspan font-family="ec-lmr" font-size="10">, with a hyphen (e.g.</tspan>
     <tspan font-family="ec-lmtt" font-size="10">OCRAM: Allocation of %u bytes failed - %r\n</tspan><tspan font-family="ec-lmr" font-size="10">).</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_CODE_BEGIN () </tspan><tspan font-family="ec-lmr" font-size="10">and </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_CODE_END () </tspan><tspan font-family="ec-lmr" font-size="10">constructions to guard debug checks that may potentially</tspan>
     <tspan font-family="ec-lmr" font-size="10">reduce the performance of release builds and are otherwise unnecessary.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG </tspan><tspan font-family="ec-lmr" font-size="10">macro to print debug messages during normal functioning, and </tspan><tspan font-family="ec-lmtt" font-size="10">RUNTIME_DEBUG </tspan><tspan font-family="ec-lmr" font-size="10">for debugging after</tspan>
     <tspan font-family="ec-lmtt" font-size="10">EXIT_BOOT_SERVICES</tspan><tspan font-family="ec-lmr" font-size="10">.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_VERBOSE </tspan><tspan font-family="ec-lmr" font-size="10">debug level to leave debug messages for future debugging of the code, which are currently</tspan>
     <tspan font-family="ec-lmr" font-size="10">not necessary. By default </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_VERBOSE </tspan><tspan font-family="ec-lmr" font-size="10">messages are ignored even in </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG </tspan><tspan font-family="ec-lmr" font-size="10">builds.</tspan>
     </li>
     <li class="itemize"><tspan font-family="ec-lmr" font-size="10">Use </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_INFO </tspan><tspan font-family="ec-lmr" font-size="10">debug level for all non critical messages (including errors) and </tspan><tspan font-family="ec-lmtt" font-size="10">DEBUG_BULK_INFO </tspan><tspan font-family="ec-lmr" font-size="10">for extensive</tspan>
     <tspan font-family="ec-lmr" font-size="10">messages that should not appear in NVRAM log that is heavily limited in size. These messages are ignored in</tspan>
     <tspan font-family="ec-lmtt" font-size="10">RELEASE </tspan><tspan font-family="ec-lmr" font-size="10">builds.</tspan>
                                                                                                  
                                                                                                  
     
     
     
     
      
     
     
      
     
     
      
     
     
      
     
                   
      
     
     
      
     
      
      
     
      
      
     
     
      
     
     
      
     
      
     
      
                                                                                                  
                                                                                                  
     
      
     
      
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
     
      
     
                                                                                                                                           </body>
</html>